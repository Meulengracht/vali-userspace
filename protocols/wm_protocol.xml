<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<root>
    <types>
        <type name="uint32_t" header="stdint.h" />
        <type name="UUId_t" header="os/osdefs.h" />
    </types>
    <enums>
        <enum name="pixel_format">
            <value name="format_a8r8g8b8" />
            <value name="format_x8r8g8b8" />
        </enum>
    </enums>
    <protocols namespace="wm">
        <protocol name="core" id="0x10">
            <enums>
                <enum name="object_type">
                    <value name="object_type_screen"></value>
                    <value name="object_type_memory"></value>
                    <value name="object_type_memory_pool"></value>
                    <value name="object_type_surface"></value>
                    <value name="object_type_buffer"></value>
                </enum>
            </enums>
            
            <functions>
                <function name="sync" synchronous="false">
                    <request>
                        <param name="serial" type="uint32_t" count="1" />
                    </request>
                    <response>
                        <param name="serial" type="uint32_t" count="1" />
                    </response>
                </function>
                <function name="get_objects" synchronous="false" />
            </functions>
            
            <events>
                <event name="error">
                    <param name="object_id" type="uint32_t" count="1" />
                    <param name="error_id" type="int" count="1" />
                    <param name="error_description" type="string" count="64" />
                </event>
                <event name="object">
                    <param name="object_id" type="uint32_t" count="1" />
                    <param name="type" type="object_type" count="1" />
                </event>
            </events>
        </protocol>
        
        <protocol name="screen" id="0x11">
            <enums>
                <enum name="mode_attributes">
                    <value name="mode_current" value="0x1"></value>
                    <value name="mode_preferred" value="0x2"></value>
                </enum>
                <enum name="transform">
                    <value name="no_transform"></value>
                    <value name="rotate_90"></value>
                    <value name="rotate_180"></value>
                    <value name="rotate_270"></value>
                </enum>
            </enums>

            <functions>
                <function name="get_properties" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                    </request>
                    <response>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="x" type="int" count="1" />
                        <param name="y" type="int" count="1" />
                        <param name="transform" type="transform" count="1" />
                        <param name="scale" type="int" count="1" />
                    </response>
                </function>
                <function name="get_modes" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                    </request>
                </function>
                <function name="set_scale" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="scale" type="int" count="1" />
                    </request>
                </function>
                <function name="set_transform" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="transform" type="transform" count="1" />
                    </request>
                </function>
                <function name="create_surface" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="width" type="int" count="1" />
                        <param name="height" type="int" count="1" />
                    </request>
                    <response>
                        <param name="object_id" type="uint32_t" count="1" />
                    </response>
                </function>
            </functions>
            
            <events>
                <event name="mode">
                    <param name="flags" type="mode_attributes" count="1" />
                    <param name="resolution_x" type="int" count="1" />
                    <param name="resolution_y" type="int" count="1" />
                    <param name="refresh_rate" type="int" count="1" />
                </event>
            </events>
        </protocol>
        
        <protocol name="memory" id="0x12">
            <functions>
                <function name="create_pool" synchronous="false">
                    <request>
                        <param name="size" type="int" count="1" />
                    </request>
                    <response>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="handle" type="UUId_t" count="1" />
                    </response>
                </function>
            </functions>
        </protocol>
        
        <protocol name="memory_pool" id="0x13">
            <functions>
                <function name="create_buffer" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="offset" type="int" count="1" />
                        <param name="width" type="int" count="1" />
                        <param name="height" type="int" count="1" />
                        <param name="stride" type="int" count="1" />
                        <param name="format" type="pixel_format" count="1" />
                    </request>
                    <response>
                        <param name="object_id" type="uint32_t" count="1" />
                    </response>
                </function>
            </functions>
        </protocol>
        
        <protocol name="surface" id="0x14">
            <enums>
                <enum name="edge">
                    <value name="no_edges" value="0" />
                    <value name="top_left" value="0x1" />
                    <value name="top_right" value="0x2" />
                    <value name="bottom_left" value="0x4" />
                    <value name="bottom_right" value="0x8" />
                </enum>
            </enums>
            
            <functions>
                <function name="get_formats" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                    </request>
                </function>
                <function name="set_buffer" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="buffer_id" type="uint32_t" count="1" />
                    </request>
                </function>
                <function name="invalidate" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="x" type="int"/>
                        <param name="y" type="int"/>
                        <param name="width" type="int"/>
                        <param name="height" type="int"/>
                    </request>
                </function>
                <function name="add_subsurface" synchronous="false">
                    <request>
                        <param name="parent_id" type="uint32_t" count="1" />
                        <param name="child_id" type="uint32_t" count="1" />
                        <param name="x" type="int"/>
                        <param name="y" type="int"/>
                    </request>
                </function>
                <function name="commit" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                    </request>
                </function>
                <function name="resize" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                        <param name="edges" type="edge"/>
                    </request>
                </function>
                <function name="destroy" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                    </request>
                </function>
            </functions>
            
            <events>
                <event name="format">
                    <param name="object_id" type="uint32_t" count="1" />
                    <param name="format" type="pixel_format" count="1" />
                </event>
                <event name="resize">
                    <param name="object_id" type="uint32_t" count="1" />
                    <param name="width" type="int" count="1" />
                    <param name="height" type="int" count="1" />
                    <param name="edges" type="edge"/>
                </event>
            </events>
        </protocol>
        
        <protocol name="buffer" id="0x15">
            <functions>
                <function name="destroy" synchronous="false">
                    <request>
                        <param name="object_id" type="uint32_t" count="1" />
                    </request>
                </function>
            </functions>
            
            <events>
                <event name="release">
                    <param name="object_id" type="uint32_t" count="1" />
                </event>
            </events>
        </protocol>
    </protocols>
</root>
